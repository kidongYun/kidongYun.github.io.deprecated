---
layout: post
title:  "Interpark - About the role of Spring Controller and Service."
date:   2020-07-15 10:00:00 +0900
categories: interpark spring
---

### 1. 스프링에서 서비스의 필요성

> 한 컨트롤러에서 사용하는 모든 로직이 오로지 그 컨트롤러에서만 사용된다고 보장할 수 없다. 예를 들어서 스프링으로 구축된 대학교 시스템이 존재한다고 하자.
그 안에서 모든 교수들의 월급의 합을 구하는 기능을 만들었을 때 이 기능이 다양한 곳에서 사용이 될 수 있기 때문에 우리는 이런 비지니스 기능들을 독립적으로 두고 다양한 컨트롤러에서
사용 가능하도록 구현하여야 한다. 


### 2. 서비스에서 함수의 설계

> 테스트 코드 작성이 원활해짐.


#### 2.1 파라미터는 모두 독립된 객체로.

> 파라미터를 입력받을 때에는 POJO 객체 혹은 양이 적다면 primitive type으로 받자. 어떠한 컨트롤러에서 사용되는 객체를 서비스의 파라미터로 직접 넣어주는게 되면 이는 벌써 그 컨트롤러와 서비스 간에 종속적인 관계가 생겨난다. 즉 그 파라미터를 만들어낼 수 없다면 그 서비스를 호출할 수 없다는 의미이다. 그러면 다른 컨트롤러에서는 이 서비스를 사용하기 어려워 진다. 그렇기에 서비스 에서 함수를 만들때에는 독립적인 순수 함수를 만들기 위해 노력해야하며 그 함수의 파라미터는 그 함수가 필요로 하는 정보들만 받는 것이 좋다.

#### 2.2 순수함수로 구현하여라 (외부 리소스를 가져오는 작업은 함수 내부에서 구현하지 말자.)

> 일반적으로 Functional Programming 을 한다고 하면 입력과 출력이 분명한 순수 함수들로 프로그램을 구현해 하나는 것을 의미한다. 함수 내부에서 새로운 객체를 생성하는 작업이나, 데이터베이스 혹은 API 를 통해 외부 데이터를 가져오는 작업을 수행한다고 하면 이 함수는 좋은 함수가 될수 없다. 개념적인 관점에서 이러한 행위들이 마땅할 수는 있지만, 만약 이렇게 파라미터 이외의 방법으로 데이터들을 가져오게 되면 테스트 코드 작성이 항상 동일한 결과를 도출할 수 없다. 또한 그 함수 자체가 독립적이지 않게 된다. (외부 리소스의 데이터에 따라 값이 달라지기 때문에 외부 환경에 종속적이라는 의미)

### 3. 서비스에서의 예외처리

> 이부분은 솔직히 아직 고민. 정답을 모르겠다. 내 생각은 그렇다. 특정 예외처리 작업은 특정 로직에 사실 언제나 종속적이다. 그래서 하나로 묶어두고 처리를 하고싶은데 이를 위해서는
try-catch를 잘 활용해야한다. 근데 전반적으로 과장님들에게 여쭤보니 다들 가독성이 좀 떨어진다고 생각하는거 같다. 다들 바로바로 이해를 못하시더라. 근데 이렇게 하면 컨트롤러도 훨씬 깔끔해져서 사실 처음에 그 커다란 한 비즈니스를 이해하는데에는 훨씬 좋다. 예외처리에 대한 코드도 중복이 줄어들고. RESTFUL하게 처리를 하게 되면 공통 예외처리로 사실 대부분의 예외도 잡게 될테니까 사실 내가볼때는 서비스에서 처리하는게 더 나은것 같음.


### 4. 중복을 줄이기 위하여

> 서비스의 모든 코드들을 독립적인 모듈로서 작성하게 되면 불가피하게 필요한 한 컨트롤러에 종속적인 작업들은 모두 컨트롤러에서 처리하게 된다. 

```java
    
    // in Service

    /** 직업 중 개발자만 뽑아 평균 월급을 계산하는 함수 */
    public double calculate(List<Person> people) {
        List<Person> developers = people.stream()
                .filter(Person::IsDeveloper)
                .collect(toList());

        averageSalary =  
    }
```

> 예외처리와 같은 것들. 혹은 서비스의 독립적인 함수들을 묶어서 새로운 함수를 구현하는 것들. 이런것들은 어떨까? 어떻게 생각이 드나